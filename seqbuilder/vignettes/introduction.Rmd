---
title: "Introduction to NAHRtoolkit"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{introductin}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  options(tibble.print_min = 4, tibble.print_max = 4)
)
```

```{r setup}
library(nahrtoolkit)
```

NAHRtoolkit provides functions to generate sequences with repetitive elements, 
invoke minimap2 to spot repeats and run tree-like algorithms to detect likely
repeat-mediated SVs. 

## Big weaknesses in implementation

bbmap shred.sh script is kinda needed but not properly installed/referred.


## Example use cases.

### `confirm_loaded_nahr()`: Check if loading has been successful

`nahrtoolkit::confirm_loaded_nahr()` Tests if loading has been successful.

```{r}
confirm_loaded_nahr()
```

### Use case 1: Make a dotplot visualisation of two fasta files. 


We start with creating two dotplots of a fasta file with itself. First, let us specify an example sequence.
(Note: the example sequence has been created from the commandline, using: 
Rscript seqbuilder_wrapper.R -l 10000 -s ../data/sds10y.tsv -o 10ktest
)

```{r}
samplefasta_link = system.file('extdata', '10ktest.fa', package='nahrtoolkit')
samplepaf_link = paste0(samplefasta_link, '.paf')
```

If the sequence is not too long, we can use an exact dotplot to visualize the ground truth.

```{r}

exact_plot = make_dotplot(samplefasta_link, samplefasta_link, 15, save=F)
print(exact_plot)
```

Alternatively, if the sequences are very long, we can also use Minimap2 to generate us a dotplot. Note how segdups are being highlighted. 

```{r, warning = FALSE, message = FALSE}

minimap2_inferred_plot = 
  make_chunked_minimap_alnment(samplefasta_link, samplefasta_link, samplepaf_link, 
                               outplot=NULL, chunklen = 500, saveplot=F, 
                               hllink = samplepaf_link, hltype = 'paf')


print(minimap2_inferred_plot)
```


### Use case 1: Make a dotplot visualisation of two fasta files. 
